<!DOCTYPE html>
<html>
<head>
    <title>Mapping Emergency Centers in Ramallah city</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-search/dist/leaflet-search.min.css" />
    <style>
        #map { height: 100vh; }
        .legend { 
            background: white; 
            line-height: 1.5em;
            padding: 6px 8px;
            font: 14px/16px Arial, Helvetica, sans-serif;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            border-radius: 5px;
        }
        .leaflet-control-search {
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
        }
        .custom-icon {
            width: 16px;
            height: 16px;
        }
    </style>
</head>
<body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-search/dist/leaflet-search.min.js"></script>
    <script>
        var map = L.map('map').setView([31.95, 35.2], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19
        }).addTo(map);

        function createGeoJsonLayer(url, propertyName, pointToLayerFunction, style) {
            var layer = L.geoJson(null, {
                pointToLayer: pointToLayerFunction,
                style: style,
                onEachFeature: function (feature, layer) {
                    layer.bindPopup(feature.properties[propertyName] || "No name");
                }
            });

            fetch(url)
                .then(response => response.json())
                .then(data => {
                    layer.addData(data);
                    if (url === 'RamallahZones.geojson') {
                        map.fitBounds(layer.getBounds());
                    }
                })
                .catch(error => console.error('Error loading GeoJSON:', error));

            return layer;
        }

        function pointToLayerFunctionFactory(color, icon) {
            return function (feature, latlng) {
                return L.marker(latlng, {
                    icon: L.divIcon({
                        className: 'custom-icon',
                        html: icon,
                        iconSize: [16, 16]
                    })
                });
            };
        }

        var zonesLayer = createGeoJsonLayer('RamallahZones.geojson', 'NAME', null, {color: 'orange', fillOpacity: 0});
        var hospitalIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-hospital" viewBox="0 0 16 16"> <path d="M8.5 5.034v1.1l.953-.55.5.867L9 7l.953.55-.5.866-.953-.55v1.1h-1v-1.1l-.953.55-.5-.866L7 7l-.953-.55.5-.866.953.55v-1.1zM13.25 9a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25zM13 11.25a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25zm.25 1.75a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25zm-11-4a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5A.25.25 0 0 0 3 9.75v-.5A.25.25 0 0 0 2.75 9zm0 2a.25.25 0 0 0-.25.25v.5c0 .138.112.25.25.25h.5a.25.25 0 0 0 .25-.25v-.5a.25.25 0 0 0-.25-.25zM2 13.25a.25.25 0 0 1 .25-.25h.5a.25.25 0 0 1 .25.25v.5a.25.25 0 0 1-.25.25h-.5a.25.25 0 0 1-.25-.25z"/> <path d="M5 1a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1a1 1 0 0 1 1 1v4h3a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1h3V3a1 1 0 0 1 1-1zm2 14h2v-3H7zm3 0h1V3H5v12h1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1zm0-14H6v1h4zm2 7v7h3V8zm-8 7V8H1v7z"/> </svg>';
        var hospitalLayer = createGeoJsonLayer('hospital.geojson', 'NAME_AR', pointToLayerFunctionFactory('red', hospitalIcon), null);
        var civilIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="16"height="16" fill="currentColor" class="bi bi-building" viewBox="0 0 16 16"> <path d="M8 1a.5.5 0 0 1 .5.5V4h3a.5.5 0 0 1 .354.854L8.354 8.854a.5.5 0 0 1-.708 0L4.146 4.854A.5.5 0 0 1 4.5 4H7V1.5a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5V12H14a.5.5 0 0 1 .447.724l-6 10a.5.5 0 0 1-.894 0l-6-10A.5.5 0 0 1 2 12h5V5.5A.5.5 0 0 1 8 5zM7 13v2h2v-2H7z"/> </svg>';
        var civilLayer = createGeoJsonLayer('ciivilld.geojson', 'Name', pointToLayerFunctionFactory('yellow', civilIcon), null);
        var pharmacyIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shop" viewBox="0 0 16 16"> <path d="M2.5 1a.5.5 0 0 1 .5.5V2h.772a1.5 1.5 0 0 1 2.688 0H8.5a1.5 1.5 0 0 1 2.688 0H13v-.5a.5.5 0 0 1 1 0v.845a.5.5 0 0 1-.176.38l-1.5 1.5a.5.5 0 0 1-.707 0L11 2.676 9.382 4.293a.5.5 0 0 1-.707 0l-1.5-1.5a.5.5 0 0 1-.176-.38V1.5a.5.5 0 0 1 .5-.5zM1 3.5a.5.5 0 0 1 .5-.5H3V14a2 2 0 0 1-2 2h12a2 2 0 0 1-2-2V3.5H14a.5.5 0 0 1 .5.5v1.63a.5.5 0 0 1-.176.38L12.705 7H10V5.42l1.146-.658a.5.5 0 0 1 .658.548L10.382 8l2.422 1.39a.5.5 0 0 1-.146.924l-3-1.732a.5.5 0 0 1-.264 0l-3 1.732a.5.5 0 0 1-.146-.924L5.618 8 3.196 6.5zM6v7h3V8H6z"/> </svg>';
        var pharmacyLayer = createGeoJsonLayer('pharmacy.geojson', 'NAME_AR', pointToLayerFunctionFactory('green', pharmacyIcon), null);

        var policeIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-shield-fill" viewBox="0 0 16 16"> <path d="M8 1a7 7 0 0 0-5.33 12.29l4.12 4.12a.5.5 0 0 0 .71 0l4.12-4.12A7 7 0 0 0 8 1zm-1.525 9.061a.5.5 0 0 1 .535-.845l1.387 1.042 2.547-3.396a.5.5 0 0 1 .854.52l-2.747 3.662a.5.5 0 0 1-.724.09l-1.387-1.042-1.267 1.899zm1.753-7.11a5 5 0 0 1 3.772 8.289l-4.654 6.205a.5.5 0 0 1-.716.078l-4.654-4.654A5 5 0 0 1 5.228 3.95l2.015 1.512a.5.5 0 0 1 .071.764l-1.854 2.473a.5.5 0 0 1-.822-.24l-1.767-3.997a5 5 0 0 1 3.773-8.29z"/> </svg>';
        var policeLayer = createGeoJsonLayer('Police.geojson', 'NAME_AR_1', pointToLayerFunctionFactory('blue', policeIcon), null);

        var baseMaps = {
            "OpenStreetMap": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 19}),
        };

        var overlayMaps = {
            "Zones": zonesLayer,
            "Hospitals": hospitalLayer,
            "Civil Defense": civilLayer,
            "Pharmacies": pharmacyLayer,
            "Police Stations": policeLayer
        };

        L.control.layers(baseMaps, overlayMaps).addTo(map);

    </script>
</body>
</html>

